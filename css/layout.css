.layout{display:grid;grid-template-columns:280px 1fr 320px;gap:.8rem;height:100vh;padding:.8rem}
#map-area{position:relative; display:flex; flex-direction:column; min-height:0}
#map-canvas{width:100%;height:100%;display:block;background:#0a0f14}
/* Sidebar sticky & scrollable */
#left-panel{position:sticky; top:.8rem; align-self:start; max-height:calc(100vh - 1.6rem); overflow:auto}
.floating-legend{position:absolute;right:1rem;bottom:1rem;z-index:50}
.floating-legend .legend-inner{background:var(--panel);border:1px solid var(--border);padding:.6rem;border-radius:1rem;box-shadow:0 6px 20px rgba(0,0,0,.5)}
.floating-legend h4{margin:0 0 .3rem 0;font-size:12px;color:#cfe1ff}
@media (max-width:1100px){
  .layout{grid-template-columns:1fr;grid-template-rows:auto 1fr auto}
  #map-area{order:2;height:70vh}
  .floating-legend{position:static;margin:.8rem auto 0 auto}
}